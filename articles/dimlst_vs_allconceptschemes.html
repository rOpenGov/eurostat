<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Differences between dimlst.dic and ALL_CONCEPTSCHEMES.xml • eurostat</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Differences between dimlst.dic and ALL_CONCEPTSCHEMES.xml">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=B612+Mono:ital,wght@0,400;0,700;1,400;1,700&amp;family=Roboto+Mono:ital,wght@0,100..700;1,100..700&amp;display=swap" rel="stylesheet">
<!-- rogtemplate style sheet --><link href="../BS5/rogtemplate.min.css" rel="stylesheet">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">eurostat</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/blogposts.html">Blog posts</a></li>
    <li><a class="dropdown-item" href="../articles/cheatsheet.html">Cheat sheet: eurostat R package</a></li>
    <li><a class="dropdown-item" href="../articles/dimlst_vs_allconceptschemes.html">Differences between dimlst.dic and ALL_CONCEPTSCHEMES.xml</a></li>
    <li><a class="dropdown-item" href="../articles/eurostat_tutorial.html">Tutorial for the eurostat R package</a></li>
    <li><a class="dropdown-item" href="../articles/mapping.html">Mapping Regional Data, Mapping Metadata Problems</a></li>
    <li><a class="dropdown-item" href="../articles/maps.html">Map examples for the eurostat R package</a></li>
    <li><a class="dropdown-item" href="../articles/publications.html">Publications using the eurostat R package</a></li>
    <li><a class="dropdown-item" href="../articles/vignette.html">Vignette for the eurostat R package</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rOpenGov/eurostat/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Differences between dimlst.dic and ALL_CONCEPTSCHEMES.xml</h1>
            
            <h4 data-toc-skip class="date">2025-02-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/rOpenGov/eurostat/blob/master/vignettes/articles/dimlst_vs_allconceptschemes.Rmd" class="external-link"><code>vignettes/articles/dimlst_vs_allconceptschemes.Rmd</code></a></small>
      <div class="d-none name"><code>dimlst_vs_allconceptschemes.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>As Eurostat is in the process of getting rid of Bulk Download
facilities, there are inevitably some changes that affect the
<code>eurostat</code> package as well. One of those is the removal of
old <code>.dic</code> objects that have been used in translating
Eurostat variable codes into cleartext labels in English, French or
German.</p>
<p>All things must pass. We have removed the old
<code><a href="../reference/label_eurostat.html">label_eurostat_vars()</a></code> function that simply downloaded
<code>dimlst.dic</code>, sort of ‘master file’ of all available codes
and their cleartext labels, and used that to label all Eurostat
datasets. Now labeling is done by downloading a Concept Scheme file for
each individual dataset and using that information to give labels to the
dataset in the desired language.</p>
</div>
<div class="section level2">
<h2 id="comparison-of-old-and-new">Comparison of old and new<a class="anchor" aria-label="anchor" href="#comparison-of-old-and-new"></a>
</h2>
<p>An example of the old English version dimlst.dic file (downloaded
2023-12-18 from <a href="https://ec.europa.eu/eurostat/estat-navtree-portlet-prod/BulkDownloadListing?sort=1&amp;dir=dic%2Fen" class="external-link">here</a>),
10 first rows:</p>
<pre class="text"><code>ACCIDENT    Accident
ACCOMMOD    Mode of accommodation 
ACCOMSIZE   Size of accommodation by number of bedplaces
ACCOMUNIT   Accommodation unit
ACL00   Classification of activities for time use
ACTIVITY    Type of activity
ADMINISTR   Administration indicator
AFFORD  Affordability
AGE Age class
AGECHILD    Age of the child
AGEDEF  Age definition</code></pre>
<p>An example of the new Concept Scheme file for dataset
<code>NAMA_10_GDP</code> (see instructions for downloading <a href="https://wikis.ec.europa.eu/display/EUROSTATHELP/API+SDMX+2.1+-+metadata+query#APISDMX2.1metadataquery-SDMX2.1endpoint-REST-SDMX-ML2.1ConceptScheme" class="external-link">here</a>):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode xml"><code class="sourceCode xml"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>&lt;<span class="kw">s:Concept</span><span class="ot"> id=</span><span class="st">"freq"</span><span class="ot"> urn=</span><span class="st">"urn:sdmx:org.sdmx.infomodel.conceptscheme.Concept=ESTAT:NAMA_10_GDP(45.0).freq"</span>&gt;</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  &lt;<span class="kw">c:Name</span><span class="ot"> xml:lang=</span><span class="st">"en"</span>&gt;</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>    Time frequency</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  &lt;/<span class="kw">c:Name</span>&gt;</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  &lt;<span class="kw">c:Name</span><span class="ot"> xml:lang=</span><span class="st">"de"</span>&gt;</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    Zeitliche Frequenz</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  &lt;/<span class="kw">c:Name</span>&gt;</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  &lt;<span class="kw">c:Name</span><span class="ot"> xml:lang=</span><span class="st">"fr"</span>&gt;</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    Fréquence (relative au temps)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  &lt;/<span class="kw">c:Name</span>&gt;</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  &lt;<span class="kw">s:CoreRepresentation</span>&gt;</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>    &lt;<span class="kw">s:Enumeration</span>&gt;</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>      &lt;<span class="kw">Ref</span><span class="ot"> agencyID=</span><span class="st">"ESTAT"</span><span class="ot"> class=</span><span class="st">"Codelist"</span><span class="ot"> id=</span><span class="st">"FREQ"</span><span class="ot"> package=</span><span class="st">"codelist"</span><span class="ot"> version=</span><span class="st">"3.2"</span>/&gt;</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>    &lt;/<span class="kw">s:Enumeration</span>&gt;</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>  &lt;/<span class="kw">s:CoreRepresentation</span>&gt;</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>&lt;/<span class="kw">s:Concept</span>&gt;</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>&lt;<span class="kw">s:Concept</span><span class="ot"> id=</span><span class="st">"unit"</span><span class="ot"> urn=</span><span class="st">"urn:sdmx:org.sdmx.infomodel.conceptscheme.Concept=ESTAT:NAMA_10_GDP(45.0).unit"</span>&gt;</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>  &lt;<span class="kw">c:Name</span><span class="ot"> xml:lang=</span><span class="st">"en"</span>&gt;</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>    Unit of measure</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>  &lt;/<span class="kw">c:Name</span>&gt;</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>  &lt;<span class="kw">c:Name</span><span class="ot"> xml:lang=</span><span class="st">"de"</span>&gt;</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>    Maßeinheit</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>  &lt;/<span class="kw">c:Name</span>&gt;</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>  &lt;<span class="kw">c:Name</span><span class="ot"> xml:lang=</span><span class="st">"fr"</span>&gt;</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>    Unité de mesure</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>  &lt;/<span class="kw">c:Name</span>&gt;</span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>  &lt;<span class="kw">s:CoreRepresentation</span>&gt;</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>    &lt;<span class="kw">s:Enumeration</span>&gt;</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>      &lt;<span class="kw">Ref</span><span class="ot"> agencyID=</span><span class="st">"ESTAT"</span><span class="ot"> class=</span><span class="st">"Codelist"</span><span class="ot"> id=</span><span class="st">"UNIT"</span><span class="ot"> package=</span><span class="st">"codelist"</span><span class="ot"> version=</span><span class="st">"22.0"</span>/&gt;</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>    &lt;/<span class="kw">s:Enumeration</span>&gt;</span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>  &lt;/<span class="kw">s:CoreRepresentation</span>&gt;</span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>&lt;/<span class="kw">s:Concept</span>&gt;</span></code></pre></div>
<p>The apparent benefit of XML presentation is that all language
versions can be found in the same file. This makes the files a bit
larger than old .tsv files but for individual datasets the size is still
manageable.</p>
<p>Concept id’s or Ref id’s (“unit”, “UNIT”) can be used to look up
further classifications in Codelists. In the old .dic metaphor all
definition files were “dictionaries” where <code>dimlst.dic</code> was a
special case, a dictionary of dictionaries, whereas in the new metaphor
there is more of a hierarchy of definitions. For example in the case of
units all available English labels can be downloaded in JSON-stat and
TSV formats:</p>
<p><a href="https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/codelist/ESTAT/UNIT?format=TSV&amp;lang=en" class="external-link uri">https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/codelist/ESTAT/UNIT?format=TSV&amp;lang=en</a>
<a href="https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/codelist/ESTAT/UNIT?format=JSON&amp;lang=en" class="external-link uri">https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/codelist/ESTAT/UNIT?format=JSON&amp;lang=en</a></p>
<p>However, the new TSV files and the old .dic files are virtually
identical:</p>
<pre class="text"><code># unit.dic
TOTAL   Total
NR  Number
NR_HAB  Number per inhabitant
THS Thousand
MIO Million
BN  Billion
CT  Euro cent
EUR Euro
THS_EUR Thousand euro
MIO_EUR Million euro
BN_EUR  Billion euro
[...]
[711 lines]

# ESTAT_UNIT_22.0_EN.tsv
TOTAL   Total
NR  Number
NR_HAB  Number per inhabitant
THS Thousand
MIO Million
BN  Billion
CT  Euro cent
EUR Euro
THS_EUR Thousand euro
MIO_EUR Million euro
BN_EUR  Billion euro
[...]
[711 lines]</code></pre>
</div>
<div class="section level2">
<h2 id="replicating-old-style-dimlst-dic-with-new-xml-files">Replicating old style dimlst.dic with new xml files<a class="anchor" aria-label="anchor" href="#replicating-old-style-dimlst-dic-with-new-xml-files"></a>
</h2>
<p>In some cases it may have been useful to access all labels for all
datasets from a single file. In theory this is possible with Concept
Schemes as well, by downlaoding all concept schemes at once in the form
of “ALL_CONCEPTSCHEMES.xml” file, at 29.7 Mb large. We can parse the xml
file to create a list that is similar to the old <code>dimlst.dic</code>
object to see if there are any functional differences.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://xml2.r-lib.org/" class="external-link">xml2</a></span><span class="op">)</span></span>
<span><span class="co"># file downloaded from https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/conceptscheme/ESTAT/?compressed=true and unpacked</span></span>
<span><span class="va">xml_object</span> <span class="op">&lt;-</span> <span class="fu">xml2</span><span class="fu">::</span><span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html" class="external-link">read_xml</a></span><span class="op">(</span><span class="st">"ALL_CONCEPTSCHEMES.xml"</span><span class="op">)</span></span>
<span><span class="va">number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">xml2</span><span class="fu">::</span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html" class="external-link">xml_find_all</a></span><span class="op">(</span><span class="va">xml_object</span>, <span class="st">".//s:Concept"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dic_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  code_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, times <span class="op">=</span> <span class="va">number</span><span class="op">)</span>,</span>
<span>  full_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, times <span class="op">=</span> <span class="va">number</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">attributes</span> <span class="op">&lt;-</span> <span class="fu">xml2</span><span class="fu">::</span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_attr.html" class="external-link">xml_attrs</a></span><span class="op">(</span><span class="fu">xml2</span><span class="fu">::</span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html" class="external-link">xml_find_all</a></span><span class="op">(</span><span class="va">xml_object</span>, <span class="st">".//s:Concept"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">contents</span> <span class="op">&lt;-</span> <span class="fu">xml2</span><span class="fu">::</span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_text.html" class="external-link">xml_text</a></span><span class="op">(</span><span class="fu">xml2</span><span class="fu">::</span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html" class="external-link">xml_find_all</a></span><span class="op">(</span><span class="va">xml_object</span>, <span class="st">".//s:Concept/c:Name[@xml:lang='en']"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">number</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dic_df</span><span class="op">$</span><span class="va">code_name</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">attributes</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="st">"id"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># This is ok because the length of &lt;s:Concept&gt; and &lt;c:Name&gt; is the same</span></span>
<span><span class="va">dic_df</span><span class="op">$</span><span class="va">full_name</span> <span class="op">&lt;-</span> <span class="va">contents</span></span></code></pre></div>
<p>We can see that there are more unique codes than labels and that some
labels are being used in several different codes:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">dic_df</span><span class="op">$</span><span class="va">full_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># [1] 586</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">dic_df</span><span class="op">$</span><span class="va">code_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># [1] 592</span></span></code></pre></div>
<p>To make the data.frame similar to the one that we would get from
reading a tab-separated .dic object:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select unique rows</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">new_df</span> <span class="op">&lt;-</span> <span class="va">dic_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># codes toupper</span></span>
<span><span class="va">new_df</span><span class="op">$</span><span class="va">code_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">$</span><span class="va">code_name</span><span class="op">)</span></span>
<span></span>
<span><span class="va">new_df_sort</span> <span class="op">&lt;-</span> <span class="va">new_df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">new_df</span><span class="op">$</span><span class="va">code_name</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># Remove row numbers</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">)</span></span>
<span><span class="co">#   code_name                                    full_name</span></span>
<span><span class="co"># 1  ACCIDENT                                     Accident</span></span>
<span><span class="co"># 2  ACCOMMOD                        Mode of accommodation</span></span>
<span><span class="co"># 3 ACCOMSIZE Size of accommodation by number of bedplaces</span></span>
<span><span class="co"># 4 ACCOMUNIT                           Accommodation unit</span></span>
<span><span class="co"># 5     ACL00    Classification of activities for time use</span></span>
<span><span class="co"># 6  ACTIVITY                             Type of activity</span></span></code></pre></div>
<p>As comparison to the <code>dimlst.dic</code> object:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># downloaded from https://ec.europa.eu/eurostat/estat-navtree-portlet-prod/BulkDownloadListing?sort=1&amp;dir=dic%2Fen</span></span>
<span><span class="va">dimlst_dic</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="st">"dimlst.dic"</span>,</span>
<span>                col_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"code_name"</span>, <span class="st">"full_name"</span><span class="op">)</span>,</span>
<span>                col_types <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html" class="external-link">cols</a></span><span class="op">(</span>.default <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_atomic.html" class="external-link">col_character</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dimlst_dic</span><span class="op">)</span></span>
<span><span class="co">##  A tibble: 6 × 2</span></span>
<span><span class="co">#   code_name full_name                                   </span></span>
<span><span class="co">#   &lt;chr&gt;     &lt;chr&gt;                                       </span></span>
<span><span class="co"># 1 ACCIDENT  Accident                                    </span></span>
<span><span class="co"># 2 ACCOMMOD  Mode of accommodation                       </span></span>
<span><span class="co"># 3 ACCOMSIZE Size of accommodation by number of bedplaces</span></span>
<span><span class="co"># 4 ACCOMUNIT Accommodation unit                          </span></span>
<span><span class="co"># 5 ACL00     Classification of activities for time use   </span></span>
<span><span class="co"># 6 ACTIVITY  Type of activity   </span></span></code></pre></div>
<p>Clearly, the two objects have different types (the former is a
data.frame, the latter is a tibble), but that doesn’t stop us from
noticing that at least the 6 first rows are similar with each other.
However, <code>dimlst.dic</code> has 623 rows while <code>new_df</code>
object has 593 rows (obs.). Let’s find out what the differences are:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">dimlst_dic</span><span class="op">$</span><span class="va">code_name</span>, <span class="va">new_df_sort</span><span class="op">$</span><span class="va">code_name</span><span class="op">)</span></span>
<span><span class="co">#  [1] "AGR_INP"    "CALCMETH"   "DIMLST"     "ECOSYST"    "ECOSYST_C"  "FARMSIZE"   "HLTH_HLE"  </span></span>
<span><span class="co">#  [8] "HOSPCARE"   "HOUS_ANI"   "INDIC_AGR"  "IND_ACCT"   "IND_IMPV"   "ISSUER"     "LEARNING"  </span></span>
<span><span class="co"># [15] "LEV_INTRF"  "MANSTO"     "NRG_FLOW"   "NRG_TECH"   "OBS_STATUS" "OGA_FAM"    "OGA_NRH"   </span></span>
<span><span class="co"># [22] "OGA_RH"     "OGA_TYPE"   "PEDS"       "PERS_INV"   "PRD_ACCT"   "PRD_AMO"    "RAWMATPR"  </span></span>
<span><span class="co"># [29] "RAWMATSEC"  "REVDATE"    "SIZE_TUR"   "TABLE_DIC"  "TIME"       "VOT_CAT"    "WEEK"      </span></span>
<span><span class="co"># [36] "YN_CARE"    "YN_DIF"     "YN_DIS" </span></span>
<span><span class="co"># length: 38 items</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">dimlst_dic</span><span class="op">$</span><span class="va">code_name</span>, <span class="va">new_df_sort</span><span class="op">$</span><span class="va">code_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># [1] 38</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">code_name</span>, <span class="va">dimlst_dic</span><span class="op">$</span><span class="va">code_name</span><span class="op">)</span></span>
<span><span class="co"># [1] "FIELDID"     "INDIC_EU"    "OBS_FLAG"    "OBS_VALUE"   "SIZEN_R2"    "TARGET"      "TARGET_FLAG"</span></span>
<span><span class="co"># [8] "TIME_PERIOD"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">code_name</span>, <span class="va">dimlst_dic</span><span class="op">$</span><span class="va">code_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># [1] 8</span></span></code></pre></div>
<p>To summarize, the old <code>dimlst.dic</code> file has 38 codes that
are not found in the <code>ALL_CONCEPTSCHEMES.xml</code> file. The new
<code>ALL_CONCEPTSCHEMES.xml</code> has 8 codes that are not found in
the old <code>dimlst.dic</code>.</p>
<p>For more information about the different fields, let’s print the
codes and their descriptions. Unique to <code>dimlst_dic</code>
object:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">dimlst_dic</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">dimlst_dic</span><span class="op">$</span><span class="va">code_name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">dimlst_dic</span><span class="op">$</span><span class="va">code_name</span>, <span class="va">new_df_sort</span><span class="op">$</span><span class="va">code_name</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span>, n <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span><span class="co"># A tibble: 38 × 2</span></span>
<span><span class="co">#    code_name  full_name                                                                     </span></span>
<span><span class="co">#    &lt;chr&gt;      &lt;chr&gt;                                                                         </span></span>
<span><span class="co">#  1 AGR_INP    Agricultural inputs                                                           </span></span>
<span><span class="co">#  2 CALCMETH   Calculation method                                                            </span></span>
<span><span class="co">#  3 DIMLST     null                                                                          </span></span>
<span><span class="co">#  4 ECOSYST    Ecosystem typology                                                            </span></span>
<span><span class="co">#  5 ECOSYST_C  Ecosystem typology - converted                                                </span></span>
<span><span class="co">#  6 FARMSIZE   Size of farm                                                                  </span></span>
<span><span class="co">#  7 HLTH_HLE   Health and life expectancy                                                    </span></span>
<span><span class="co">#  8 HOSPCARE   Hospital care                                                                 </span></span>
<span><span class="co">#  9 HOUS_ANI   Animal housing                                                                </span></span>
<span><span class="co"># 10 INDIC_AGR  Agricultural indicators                                                       </span></span>
<span><span class="co"># 11 IND_ACCT   Industries and accounting items                                               </span></span>
<span><span class="co"># 12 IND_IMPV   Industries, imports and valuations                                            </span></span>
<span><span class="co"># 13 ISSUER     Type of issuer                                                                </span></span>
<span><span class="co"># 14 LEARNING   Learning form                                                                 </span></span>
<span><span class="co"># 15 LEV_INTRF  Level of interference                                                         </span></span>
<span><span class="co"># 16 MANSTO     Manure storage                                                                </span></span>
<span><span class="co"># 17 NRG_FLOW   Energy flows                                                                  </span></span>
<span><span class="co"># 18 NRG_TECH   Energy technologies                                                           </span></span>
<span><span class="co"># 19 OBS_STATUS Observation status (Flag)                                                     </span></span>
<span><span class="co"># 20 OGA_FAM    Other gainful activity of the family members                                  </span></span>
<span><span class="co"># 21 OGA_NRH    Other gainful activity of the holder (not related to the agricultural holding)</span></span>
<span><span class="co"># 22 OGA_RH     Other gainful activity of the holder (related to the agricultural holding)    </span></span>
<span><span class="co"># 23 OGA_TYPE   Types of other gainful activity (OGA) related to the agricultural holding     </span></span>
<span><span class="co"># 24 PEDS       Potential Environmentally Damaging Subsidies (ESA transfers)                  </span></span>
<span><span class="co"># 25 PERS_INV   Persons involved in the accident                                              </span></span>
<span><span class="co"># 26 PRD_ACCT   Products and accounting items                                                 </span></span>
<span><span class="co"># 27 PRD_AMO    Products, adjustments and market output                                       </span></span>
<span><span class="co"># 28 RAWMATPR   Primary raw materials                                                         </span></span>
<span><span class="co"># 29 RAWMATSEC  Secondary raw materials                                                       </span></span>
<span><span class="co"># 30 REVDATE    Revision date                                                                 </span></span>
<span><span class="co"># 31 SIZE_TUR   Size classes of turnover                                                      </span></span>
<span><span class="co"># 32 TABLE_DIC  null                                                                          </span></span>
<span><span class="co"># 33 TIME       Period of time                                                                </span></span>
<span><span class="co"># 34 VOT_CAT    Category of voters                                                            </span></span>
<span><span class="co"># 35 WEEK       Calendar week                                                                 </span></span>
<span><span class="co"># 36 YN_CARE    Use of profesional care - Yes/No                                              </span></span>
<span><span class="co"># 37 YN_DIF     Difficulties - Yes/No                                                         </span></span>
<span><span class="co"># 38 YN_DIS     Disability - Yes/No    </span></span></code></pre></div>
<p>Unique to new_df or new_df_sort:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_df_sort</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">code_name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">code_name</span>, <span class="va">dimlst_dic</span><span class="op">$</span><span class="va">code_name</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#       code_name                        full_name</span></span>
<span><span class="co"># 152     FIELDID             Agricultural product</span></span>
<span><span class="co"># 221    INDIC_EU    Indicators for EU2020 project</span></span>
<span><span class="co"># 364    OBS_FLAG        Observation status (Flag)</span></span>
<span><span class="co"># 365   OBS_VALUE                Observation value</span></span>
<span><span class="co"># 464    SIZEN_R2  Enterprise size and Nace Rev. 2</span></span>
<span><span class="co"># 502      TARGET         TARGET Observation value</span></span>
<span><span class="co"># 503 TARGET_FLAG TARGET Observation status (Flag)</span></span>
<span><span class="co"># 510 TIME_PERIOD                             Time</span></span></code></pre></div>
<p>Of these, “FIELDID / Agricultural product” seems almost like an input
error as there are also “prod_apr / Agricultural product (old codes)”
and “agriprod / Agricultural products” on the list. If that were the
case, the correct course of action is to of course give feedback to
Eurostat.</p>
</div>
<div class="section level2">
<h2 id="types-of-duplicates">Types of duplicates<a class="anchor" aria-label="anchor" href="#types-of-duplicates"></a>
</h2>
<p>There are also some duplicates in the list created from the XML file.
Duplicates exist both in the <code>code_name</code> column or in the
<code>full_name</code> column.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_df_sort</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">code_name</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#     code_name               full_name</span></span>
<span><span class="co"># 471    SO_EUR Standardoutput in Euros</span></span>
<span></span>
<span><span class="va">new_df_sort</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">full_name</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#     code_name                                               full_name</span></span>
<span><span class="co"># 35   ASYL_APP                                          Applicant type</span></span>
<span><span class="co"># 179    HHTYPE                                       Type of household</span></span>
<span><span class="co"># 227 INDIC_INN                                    Innovation indicator</span></span>
<span><span class="co"># 233 INDIC_NRG                                        Energy indicator</span></span>
<span><span class="co"># 237 INDIC_SBS Economical indicator for structural business statistics</span></span>
<span><span class="co"># 452  SECTPART                                       Sector (ESA 2010)</span></span>
<span><span class="co"># 528        TY                                     Type of expenditure</span></span></code></pre></div>
<p>The differences can be due to typos (probably ?):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">new_df_sort</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">code_name</span> <span class="op">==</span> <span class="st">"SO_EUR"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#     code_name                full_name</span></span>
<span><span class="co"># 470    SO_EUR Standard output in Euros</span></span>
<span><span class="co"># 471    SO_EUR  Standardoutput in Euros</span></span>
<span></span>
<span><span class="va">new_df_sort</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">full_name</span> <span class="op">==</span> <span class="st">"Type of household"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#     code_name         full_name</span></span>
<span><span class="co"># 178     HHTYP Type of household</span></span>
<span><span class="co"># 179    HHTYPE Type of household</span></span>
<span></span>
<span><span class="va">new_df_sort</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">full_name</span> <span class="op">==</span> <span class="st">"Innovation indicator"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#     code_name            full_name</span></span>
<span><span class="co"># 226  INDIC_IN Innovation indicator</span></span>
<span><span class="co"># 227 INDIC_INN Innovation indicator</span></span>
<span></span>
<span><span class="va">new_df_sort</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">full_name</span> <span class="op">==</span> <span class="st">"Economical indicator for structural business statistics"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#     code_name                                               full_name</span></span>
<span><span class="co"># 236  INDIC_SB Economical indicator for structural business statistics</span></span>
<span><span class="co"># 237 INDIC_SBS Economical indicator for structural business statistics</span></span></code></pre></div>
<p>…or due to actual differences (?) in the fields, although there could
also be some kind of a misunderstanding:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Different types of applicants</span></span>
<span><span class="va">new_df_sort</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">full_name</span> <span class="op">==</span> <span class="st">"Applicant type"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#    code_name      full_name</span></span>
<span><span class="co"># 24 APPLICANT Applicant type</span></span>
<span><span class="co"># 35  ASYL_APP Applicant type</span></span>
<span></span>
<span><span class="va">new_df_sort</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">full_name</span> <span class="op">==</span> <span class="st">"Energy indicator"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#     code_name        full_name</span></span>
<span><span class="co"># 218  INDIC_EN Energy indicator</span></span>
<span><span class="co"># 233 INDIC_NRG Energy indicator</span></span>
<span></span>
<span><span class="va">new_df_sort</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">full_name</span> <span class="op">==</span> <span class="st">"Sector (ESA 2010)"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#     code_name         full_name</span></span>
<span><span class="co"># 450  SECTOR10 Sector (ESA 2010)</span></span>
<span><span class="co"># 452  SECTPART Sector (ESA 2010)</span></span>
<span></span>
<span><span class="va">new_df_sort</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">new_df_sort</span><span class="op">$</span><span class="va">full_name</span> <span class="op">==</span> <span class="st">"Type of expenditure"</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#     code_name           full_name</span></span>
<span><span class="co"># 144     EXPEN Type of expenditure</span></span>
<span><span class="co"># 528        TY Type of expenditure</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Changes in methods of delivering metadata affect, naturally, all end
users of Eurostat data. With the eurostat package version 4.0.0 we have
aimed at retaining the user-facing functionalities and the expected
outputs. The interesting world of XML parsing is kept under the hood and
should not be of concern for users.</p>
<p>This document is written mainly as a future reference for ourselves
if we might at some point be wondering why something that was possible
before is not possible anymore, or for users who have had scripts
relying on functions like <code><a href="../reference/label_eurostat.html">label_eurostat_vars()</a></code>.</p>
<p>Feel free to open an issue or a pull request in Github if there are
any suggestions or corrections you would like to make.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Leo Lahti, Janne Huovari, Markus Kainu, Przemyslaw Biecek, Pyry Kantanen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>



    <!-- Add ropengov logo -->
  <script src="../BS5/logo.js"></script>
</body>
</html>
